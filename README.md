# README

## Описание

Программа предназначена для шифрования и расшифровки файлов. Работа выполняется в два этапа:
1. Создаётся временный файл, в который записывается результат шифрования или расшифровки.
2. Если запись прошла успешно, временный файл переименовывается в оригинальное имя файла, полностью заменяя его.

Это обеспечивает целостность данных и предотвращает повреждение исходного файла в случае ошибки.

## Требования к окружению

Для корректной работы программы необходимо наличие ключа и размера блока. Они могут быть предоставлены одним из двух способов:

1. Файл `credentials.toml`, расположенный рядом с исполняемым файлом.
   Пример структуры:
   ```toml
   key = "ваш_ключ"
   chunk_size = 4096
   ```

2. Переменные окружения:
   - `CRYPTO_KEY`
   - `CRYPTO_CHUNK_SIZE`

Файл `credentials.toml` является необязательным. Если он отсутствует, программа использует только переменные окружения.

## Использование

Программа принимает два аргумента командной строки:

1. Команда:
   - `prepare` — подготовка файла (операция шифрования).
   - `read` — чтение зашифрованного файла.
   - `decrypt` — расшифровка.

2. Путь к файлу, над которым выполняется операция.

Пример вызова:

```
crypto_files prepare ./data/file.txt
crypto_files decrypt ./data/file.txt
```

## Принцип работы

Алгоритм обработки файла реализован следующим образом:

1. Открывается исходный файл.
2. Создаётся временный файл во временной директории.
3. Данные последовательно читаются блоками (`chunk_size`) и обрабатываются.
4. Результат записывается в временный файл.
5. После успешного завершения операции временный файл переименовывается в путь исходного файла.

## Структура проекта

Проект организован по принципам разделения ответственности:

- `application` — бизнес-логика приложения.
- `domain` — модели данных, доменные сущности, интерфейсы и трейт-контракты.
- `infrastructure` — реализации сервисов, определённых в `domain`.
- `interface` — внешние точки входа, включая парсинг аргументов командной строки и выполнение команд.
